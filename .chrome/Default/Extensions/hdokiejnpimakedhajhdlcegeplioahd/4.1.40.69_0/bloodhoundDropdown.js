BloodhoundDropdown=function(b,a,c,f){TypeaheadDropdown.call(this,b,null,f);a.datumTokenizer=a.datumTokenizer||Bloodhound.tokenizers.whitespace;a.queryTokenizer=a.queryTokenizer||Bloodhound.tokenizers.whitespace;a.remote=a.remote||{};a.remote.transport=function(b,a,c){bg.LPServer.ajax($.extend(b,{success:function(b,c,d){a(b)},error:function(b,a,d){c(d)}}))};this.bloodhound=new Bloodhound(a);this.optionLabel=LPTools.getOption(c,"optionLabel",null);this.elementTemplate=LPTools.getOption(c,"elementTemplate",
null);this.getValueFromDatum=LPTools.getOption(this.elementTemplate,"value",null);this.ignoreDatum=LPTools.getOption(c,"ignore",null);this.focused=!1;(function(a){var c=$(b);c.unbind("focus");c.bind("focus",function(){a.focused=!0});c.bind("blur",function(){a.focused=!1})})(this)};BloodhoundDropdown.prototype=Object.create(TypeaheadDropdown.prototype);BloodhoundDropdown.constructor=BloodhoundDropdown;
(function(){BloodhoundDropdown.prototype.fireOnChange=function(b){if(null!==this.onChangeCallback&&this.options&&this.options[b])this.onChangeCallback(this.options[b].datum,b)};BloodhoundDropdown.prototype.getInputValue=function(b){if(this.getValueFromDatum)return this.getValueFromDatum(b.datum);TypeaheadDropdown.prototype.getInputValue.apply(this,arguments)};BloodhoundDropdown.prototype.processBloodhoundResponse=function(b,a){if(this.focused&&0<b.length){for(var c=[],f=0,g=b.length;f<g;++f){var d=
b[f],e=this.bloodhound.identify(d);null!==this.ignoreDatum&&this.ignoreDatum(e,d)||(e={value:e,label:this.optionLabel(d),datum:d},this.elementTemplate&&(e.element=this.elementTemplate.template(d)),c.push(e),0===f&&this.queryMatches(e,a)&&this.setHint(a,e))}this.setOptions(c);a&&this.show()}else this.hide(),this.clearHint()};BloodhoundDropdown.prototype.updateDropdown=function(b){(function(a){var c=function(c){a.processBloodhoundResponse(c,b)};a.bloodhound.search(b,c,c)})(this)}})();
